# 引言

## 编写目的

本文档系统的分析旧有的开发流程，阐述各个环节中可能影响开发效率与质量的原因。

依据敏捷开发思想，从各个开发环节设计一套解决方案，旨在全方位提高开发的效率与质量。

## 名词解释

## 简写和缩略词

# 可行性分析

## 背景分析

### 传统开发流程

​传统开发流程在漫长的实践中积累了很多弊端：

- 每个流程必须完成本次迭代所有任务，才能进行下次迭代
- 由于迭代周期过长，进度缓慢的任务临近交付才被发现，严重影响交付进度
- 任务与开发者关联不紧密，任务粒度过大，不能清晰的跟踪事务进展及开发者当前的工作状态
- 测试介入过晚，问题集中暴露，导致开发流程不够平滑
- 一个需求从提出到交付要经历开发与测试阶段，同样很容易埋下隐患

### 敏捷开发流程

​敏捷开发流程有很多显而易见的优点：

- 以开发者为中心，将事务拆分到可以分配给一个开发者完成的粒度
- 持续测试与交付，保证每个事务都可以交付，发现问题及时解决，不留隐患
- 积极的面对变化，在开发单元足够小的基础上，需求变更的负面影响被降到最小
- 基于事务去迭代，每个事物从需求到交付都是独立的，除非有依赖关系
- 保持成果物可用，由于每个事务的完成都伴随着通过测试的成果物，所以产品始终是可以展示的

​综上所述，敏捷开发比以往的开发流程更健康。

## 发展路线

- 变更事物划分粒度

  新需求的引入在任务划分时要求粒度足够小，明确的验收目标可以让开发者更容易自测
- 从开发者开始敏捷

  要求开发者用更高的标准约束自己，通过适量的单元测试，保证自己的任务产出可以测试，并能通过测试
- 持续进程模块集成

  在各个模块可用的基础上，进行持续集成，同时确保个模块能够对接
- 持续测试交付成果

  测试的工作延伸到整个开发流程中，由于开发提交的代码质量有所提高，测试目标也比以往明确，所以测试的工作会变得平滑；通过测试的成果物随时可以交付，展示给客户或者其他关心项目整体的项目参与者

# 敏捷开发

## 敏捷事务

敏捷开发中标准的事物用Story表示，敏捷体系围绕着Story展开。Story的集合称为Epic，Story分割成更小的可执行任务称为Task。冲刺会根据Story Point或者Task的数量来评估工作量。在用户故事中定义了：

- 用户使用的场景

  用户在什么样的情况下会使用到这个功能
- 用户可以进行怎样的操作

  用户在实际使用过程中获得的(交互)体验
- 用户最终期望或者能够实现的目标

  用户最终会得到的成果物

### 事务流程

将开发任务可能经历的复数个阶段组成序列，使任务在可控的流程运行，这个序列称为工作流。每个事物可以根据实际情况有不同的工作流程，由项目实际配置决定。
开发任务通常经历三个阶段：
- 待办阶段

  敏捷事物从需求确定会被开发后进入待办阶段，在这个阶段事物可能会进行评估，以便统计冲刺的工作量。未通过评估的事物可能会被移除本次冲刺，通过评估的事物会在适当的时侯分配给开发者，进入开发者开发队列，并在开发者开始开发的时候进入实施阶段。

- 实施阶段

  敏捷事物在实施阶段被分配给开发者进行开发，为了保证开发团队足够“敏捷”，一般会限制开发者同时被分配的任务数量，这样可以保证开发者能专注的进行一个事物的开发。

  一个事物的开发过程完成后进入QA阶段，这个阶段可以包含测试，集成以及评审。
- 完成阶段

  进入完成阶段的事物有两种，通过评审的开发任务和被放弃的开发任务。

### 冲刺迭代
迭代在敏捷开发中被称作冲刺，整个开发流程由多个可控的冲刺组成。敏捷开发的冲刺通常通过看板来展示，通过维持每条泳道上始终保持有限个事物在进行中，来控制开发的节奏。

## 协同开发
通过用多个本地服务组建的协同开发环境可以极大提升团队开发效率，对追求高效的敏捷开发模式来说更是如此。通过自动化工具实现重复而简单的事物服务化，既能提升传统运维的工作效率，也能减少开发者之间的沟通成本。

### 持续集成
持续集成在模块化的软件开发中扮演重要的角色，在每个模块保证自己交付质量的基础上，多个模块的集成可以配置为自动化任务独立运行。定期或者以项目代码提交为触发条件发起持续集成任务，项目可以在无需人为干预的情况下自动将开发模块集成到一起，并进行打包发布。

### 持续交付
在自动化测试介入的情况下，可以直接在自动化集成完成后调用测试任务。通过测试的软件发布成果可以直接进行交付，极大的缩短开发到成果展示的流程。

### 协同与反馈
降低开发过程中交流成本是协同开发的首要目标，一般开发过程中进行沟通主要依靠会议、口头交流、邮件、聊天工具等。当前有很多协同开发的沟通工具，通过其提供的接口连接协同开发环境中其他的服务可以极大地提升开发效率。自动的邮件提醒以及基于操作系统本地应用的消息提醒功能可以有效地减少工作组的沟通成本。

协同服务可以通过邮件使开发者获得自己关心的信息；也可以通过本地化的即时通信工具，获取各个服务的信息后，在本地化应用中进行展示。

# 解决方案
协同开发已有丰富的工具栈，其中不乏大量高质量的开源工具，可以方便的进行二次开发。协同开发工具本身就面向开发者，往往提供有好的开发接口，也可以通过插件的方式进行扩展与二次开发。

## 事务管理
事物以Story为基本单位，以Epic为事物容器，以Task为事物分割执行单位，项目需求确立后：
- 根据需求文档编写用户故事
- 根据用户故事创建Story
- 根据事物分组创建Epic并将Story关联至Epic
- 根据开发单位将Story分为可执行的Task

事物的产生需要贯彻敏捷开发中用户故事的理念，这有助于更好的划分可评估的开发任务。

项目开发过程中事物根据来源分为两类：

- 由需求产生的事物
- 由缺陷产生的事物

由缺陷产生的事物在评估确认需要修复后应优先处理。

## 流程管理
敏捷流程管理是敏捷开发协同工作环境工具栈的核心组成部分，软件开发的整个流程都可以在工具上进行管控，过长的流程可以拆分成多个工作流组成的事物链，使不同的工作组能只通过自己的职能窗口处理事物：

- 需求分析：需求 => 用户故事 => 事物 => 评估 => 冲刺
- 敏捷冲刺：待办 => 实施 => 评审
- 集成部署：单元测试 => 集成 => 整体测试 => 发布 => 部署

## 质量控制
缺陷的发现的主体从测试和客户向开发转移：
- 开发应该通过提高代码质量和进行单元测试的方式尽量保证质量，而不是堆积不稳定的代码
- 测试的主要工作是验收开发提交的成果满足预期，而不是发现缺陷

### 模块开发
每个模块的开发过程不应直接提交到版本主线分支，而是根据功能区域建立独立的开发分支进行开发。在经过代码评审后才能被合并到主线分支上。
每个功能性独立模块在开发的同时，应该编写能覆盖所开发功能点的单元测试，并保证合并到主线分支的模块能通过单元测试

### 自动化测试
测试流程应尽量通过测试脚本自动执行实现，尤其是持续集成发布的成果，应实现每次持续集成发布后，触发脚本自动进行测试。

### 责任跟踪
开发者在提交代码时应该将提交与相关事务进行关联，以保证通过事务可以追踪相关代码。同时在代码出现质量问题时，能第一时间定位问题与责任人。

## 迭代管理
在冲刺开始前应进行敏捷评估会议，对事务进行评估，以确定整个冲刺的工作量，以及冲刺周期。冲刺应尽量以版本发布作为目标，包含完整的发布流程，可交付成果物的产生有助于保持开发团队的健康。

冲刺过程中应对各个阶段的事物数量加以限制，以保证开发者在良好的状态下工作。冲刺结束仍未能完成的事物不应该影响冲刺结束时间，而是直接移动到下一次冲刺来完成。
